


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="teal"/> 
<link rel="icon" type="image" href="africaOnlineIcon.png"/>
<title>Study or Lesson Timetable Generator</title>
<style>
    /* CSS UNCHANGED */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: georgia; }
    body { background: linear-gradient(to right, teal, maroon); color: #333; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; border: 1px solid orange; border-radius: 6px; margin-top: 1px; }
    .container { max-width: 1200px; width: 100%; text-align: center; }
    header { margin-bottom: 30px; color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
    h1 { font-size: 2.8rem; margin-bottom: 10px; color: orange; }
    .subtitle { font-size: 1.2rem; opacity: 0.9; color: orange; }
    .btn { background: #FFC107; color: #333; border: none; padding: 15px 30px; font-size: 1.2rem; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); font-weight: bold; margin: 20px 0; }
    .btn:hover { background: #FFD54F; transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 1000; overflow-y: auto; }
    .modal-content { background: linear-gradient(to right, maroon, teal); margin: 5% auto; padding: 13px; border-radius: 15px; width: 90%; max-width: 1000px; box-shadow: 0 5px 30px rgba(0,0,0,0.3); position: relative; border: 1px solid orange; color: orange; }
    .close { position: absolute; top: 20px; right: 25px; font-size: 28px; cursor: pointer; color: #aaa; }
    .close:hover { color: #333; }
    h2 { color: #2575fc; margin-bottom: 20px; font-size: 2rem; }
    .form-section { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); margin-bottom: 25px; }
    .form-group { margin-bottom: 20px; text-align: left; }
    label { display:block; margin-bottom:8px; font-weight:600; color: teal; }
    .subjects-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px,1fr)); gap: 15px; margin-top: 10px; }
    .subject-checkbox { display:flex; align-items:center; gap:10px; padding:10px; border-radius:8px; background:linear-gradient(to right, maroon, teal); color:orange; border:1px solid orange; accent-color:orange; }
    select,input[type="number"],input[type="time"] { width:100%; padding:12px; border:2px solid #ddd; border-radius:8px; font-size:16px; }
    .timetable-container { margin-top:30px; overflow-x:auto; }
    .timetable { width:100%; margin-top:20px; box-shadow:0 3px 10px rgba(0,0,0,0.1); border:1px solid orange; color:teal; }
    .timetable th { background-color: teal; color: orange; padding:15px; border:1px solid orange; }
    .timetable td { padding:15px; border:1px solid teal; background-color: lightgray; }
    .timetable tr:nth-child(even) td { background-color: orange; }
    .break { background-color: maroon !important; color: orange !important; font-weight: bold; }
    .action-buttons { display:flex; gap:15px; justify-content:center; flex-wrap:wrap; margin-top:30px; }
    .btn-generate { background:#4CAF50; color:white; }
    .btn-download { background:#2196F3; color:white; }
    .btn-reset { background:#f44336; color:white; }
    footer { margin-top:40px; color:orange; font-size:.7rem; }
    select,input { color: teal; background: orange; }
    .picturee { width:30px; height:30px; border:1px solid orange; border-radius:20px; }
    p,h1 { border:1px solid orange; border-radius:10px; background:linear-gradient(to right, maroon, teal); }
</style>
</head>
<body>

<div class="container">
<header>
    <img class="picturee" src="africaOnlineIcon.png"/> <br><br>
    <h1>Timetable Generator</h1><br>
    <p class="subtitle">Create and download your personalized school timetable in minutes</p>
</header><br>

<button id="openModal" class="btn" style="border:1px solid gray;">Generate Timetable</button><br>

<div id="timetableModal" class="modal">
<div class="modal-content">
<span class="close">&times;</span>
<h2 style="color:orange;">Create Your Timetable</h2>

<div class="form-section">

<div class="form-group">
<label>Select Your Subjects:</label>
<div class="subjects-grid">
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Chichewa" checked> Chichewa</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="English" checked> English</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Mathematics" checked> Mathematics</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Additional Mathematics"> Additional Mathematics</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Biology" checked> Biology</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Chemistry" checked> Chemistry</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Physics" checked> Physics</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="History"> History</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Geography"> Geography</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Agriculture"> Agriculture</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Social Studies"> Social Studies</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Computer Studies"> Computer Studies</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Commerce"> Commerce</label>
<label class="subject-checkbox"><input type="checkbox" name="subject" value="Bible Knowledge"> Bible Knowledge</label>
</div>
</div>

<div class="form-group">
<label for="days">Number of Days per Week:</label>
<select id="days">
<option value="5">5 Days (Mon–Fri)</option>
<option value="6">6 Days (Mon–Sat)</option>
</select>
</div>

<div class="form-group">
<label for="periods">Number of Periods per Day:</label>
<select id="periods">
<option value="6">6 Periods</option>
<option value="7">7 Periods</option>
<option value="8" selected>8 Periods</option>
<option value="9">9 Periods</option>
<option value="10">10 Periods</option>
</select>
</div>

<div class="form-group">
<label for="startTime">Start Time:</label>
<input type="time" id="startTime" value="07:30">
</div>

<div class="form-group">
<label for="duration">Duration per Period (minutes):</label>
<input type="number" id="duration" value="40" min="20" max="120">
</div>

<div class="form-group">
<label for="breakDuration">Break Duration (minutes):</label>
<input type="number" id="breakDuration" value="20" min="5" max="60">
</div>

<div class="action-buttons">
<button id="generateBtn" class="btn btn-generate" style="border:1px solid gray;background:teal;color:orange;font-size:12px;">Generate Timetable</button>
<button id="downloadBtn" class="btn btn-download" disabled style="border:1px solid gray;background:orange;color:teal;font-size:12px;">Download CSV</button>
<button id="downloadPDFBtn" class="btn btn-download" disabled style="border:1px solid gray;background:orange;color:teal;font-size:12px;">Download PDF</button>
<button id="resetBtn" class="btn btn-reset" style="border:1px solid gray;background:maroon;color:orange;font-size:12px;">Reset</button>
</div>
</div>

<div class="timetable-container">
<h3>Your Timetable</h3>
<div id="timetableOutput"></div>
</div>
</div>
</div><br><br><br>

<footer>
<p style="border-radius: 5px;">&copy;2025 SMTechnology School Timetable Generator</p>
</footer>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const modal = document.getElementById('timetableModal');
document.getElementById('openModal').onclick = () => modal.style.display = 'block';
document.querySelector('.close').onclick = () => modal.style.display = 'none';
window.onclick = e => { if(e.target === modal) modal.style.display = 'none'; };

const generateBtn = document.getElementById('generateBtn');
const downloadBtn = document.getElementById('downloadBtn');
const downloadPDFBtn = document.getElementById('downloadPDFBtn');
const resetBtn = document.getElementById('resetBtn');
const timetableOutput = document.getElementById('timetableOutput');

generateBtn.addEventListener('click', generateTimetable);
downloadBtn.addEventListener('click', downloadTimetable);
downloadPDFBtn.addEventListener('click', downloadPDF);
resetBtn.addEventListener('click', resetForm);

function formatTime(totalMinutes) {
    let hrs = Math.floor(totalMinutes / 60);
    let mins = totalMinutes % 60;
    let suffix = hrs >= 12 ? "PM" : "AM";
    hrs = hrs % 12 || 12;
    return `${hrs}:${mins.toString().padStart(2,"0")} ${suffix}`;
}

function generateTimetable() {
    const subjects = Array.from(document.querySelectorAll('input[name="subject"]:checked')).map(s => s.value);
    if(subjects.length === 0) return alert("Select at least one subject");

    const daysCount = parseInt(document.getElementById('days').value);
    const periodsCount = parseInt(document.getElementById('periods').value);
    const duration = parseInt(document.getElementById('duration').value);
    const breakDuration = parseInt(document.getElementById('breakDuration').value);

    let [sh, sm] = document.getElementById('startTime').value.split(":").map(Number);
    let current = sh * 60 + sm;

    // BREAKS AT 1/3 AND 2/3
    const breakIndices = [Math.floor(periodsCount/3), Math.floor(2*periodsCount/3)];
    const timeSlots = [];

    for (let i = 0; i < periodsCount; i++) {
        if (breakIndices.includes(i)) {
            let breakStart = current;
            let breakEnd = current + breakDuration;
            timeSlots.push({ type:"break", time: `${formatTime(breakStart)} - ${formatTime(breakEnd)}` });
            current = breakEnd;
        }

        let pStart = current;
        let pEnd = current + duration;
        timeSlots.push({ type:"period", time: `${formatTime(pStart)} - ${formatTime(pEnd)}` });
        current = pEnd;
    }

    const dayNames = ["Monday","Tuesday","Wednesday","Thursday","Friday"];
    if (daysCount === 6) dayNames.push("Saturday");

    const subjectSlots = Array.from({length: periodsCount * daysCount}, () => subjects[Math.floor(Math.random() * subjects.length)]);

    let html = `<table class="timetable"><tr><th>Period</th><th>Time</th>`;
    dayNames.forEach(d => html += `<th>${d}</th>`);
    html += `</tr>`;

    let subjectIndex = 0;

    for (let i = 0; i < timeSlots.length; i++) {
        if (timeSlots[i].type === "break") {
            html += `<tr class="break"><td class="break">BREAK</td><td class="break">${timeSlots[i].time}</td>`;
            for (let j = 0; j < daysCount; j++) html += `<td class="break">BREAK</td>`;
            html += `</tr>`;
            continue;
        }

        html += `<tr><td class="period">Period ${i+1}</td><td>${timeSlots[i].time}</td>`;
        for (let j = 0; j < daysCount; j++) html += `<td>${subjectSlots[subjectIndex++]}</td>`;
        html += `</tr>`;
    }

    html += `</table>`;
    timetableOutput.innerHTML = html;

    downloadBtn.disabled = false;
    downloadPDFBtn.disabled = false;
}

function resetForm(){
    const defaultSubs = ["Chichewa","English","Mathematics","Biology","Chemistry","Physics"];
    document.querySelectorAll('input[name="subject"]').forEach(cb => cb.checked = defaultSubs.includes(cb.value));
    document.getElementById("days").value = "5";
    document.getElementById("periods").value = "8";
    document.getElementById("startTime").value = "07:30";
    document.getElementById("duration").value = "40";
    document.getElementById("breakDuration").value = "20";
    timetableOutput.innerHTML = "";
    downloadBtn.disabled = true;
    downloadPDFBtn.disabled = true;
}

function downloadTimetable(){
    const table = document.querySelector('.timetable');
    if(!table) return alert("Generate timetable first");
    let csv = "Timetable\n";
    for (let row of table.rows) {
        csv += Array.from(row.cells).map(c => `"${c.innerText}"`).join(",") + "\n";
    }
    const blob = new Blob([csv], {type:"text/csv"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "timetable.csv";
    a.click();
}

async function downloadPDF(){
    const table = document.querySelector('.timetable');
    if(!table) return alert("Generate timetable first");
    const canvas = await html2canvas(table, {scale:2});
    const pdf = new jspdf.jsPDF("p","mm","a4");
    const img = canvas.toDataURL("image/png");
    const width = pdf.internal.pageSize.getWidth();
    const height = canvas.height * (width / canvas.width);
    pdf.addImage(img, "PNG", 0, 10, width, height);
    pdf.save("timetable.pdf");
}
</script>

<script src="profiler.js"></script>

</body>
</html>